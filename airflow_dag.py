import airflow
import pandas as pd
from airflow import DAG

from airflow.operators.python import PythonOperator
from datetime import timedelta, datetime
import pip
import vk
import time
import stanza
import re


default_args = {
    "owner": "Alexander Katynsus",
    # 'start_date': airflow.utils.dates.days_ago(2),
    # 'end_date': datetime(),
    # 'depends_on_past': False,
    # 'email': ['airflow@example.com'],
    # 'email_on_failure': False,
    # 'email_on_retry': False,
    # If a task fails, retry it once after waiting
    # at least 5 minutes
    # 'retries': 1,
    "retry_delay": timedelta(minutes=5),
}


with DAG(
    dag_id="POI_DAG",
    default_args=default_args,
    # schedule_interval='0 0 * * *',
    schedule_interval="@once",
    dagrun_timeout=timedelta(minutes=60),
    description="Get data of a city",
    start_date=airflow.utils.dates.days_ago(1),
    catchup=False,
) as dag:
    stanza.download("ru")

    nlp = stanza.Pipeline(lang="ru", processors="tokenize,ner")
    token = "vk1.a.JnoCwGWUs_3-iONmrB1h-WgKvXHbyER_pZ9CWrIE37_1UKFdaTDLOLgMsdtyiTyulz9F8kBh0IJBrTdm_qMtpPsx_sX3S9bt1Uy2ndrYAqBeK19TvXjo8bgV7JgDShU-YghTstW9_qnIqwljMi_ABYy3WjOH6Q4O57boz1h-YEz3zLE0o6f0Y50cPCkHRLNUOVkZ2K_xQ_hkJVJC9Xiy4w"
    vk_api = vk.API(access_token=token)

    start_date = datetime.now().date()

    final_date = start_date - timedelta(days=7)

    start_date, final_date = time.mktime(start_date.timetuple()), time.mktime(final_date.timetuple())
    latitude, longitude = 53.0816435, 49.9100919

    def remove_emoji(text):
        regrex_pattern = re.compile(
            pattern="["
            "\u231A-\u231B"
            "\u23E9-\u23EC"
            "\u25FD-\u25FE"
            "\u2614-\u2615"
            "\u2648-\u2653"
            "\u26AA-\u26AB"
            "\u26BD-\u26BE"
            "\u26C4-\u26C5"
            "\u26F2-\u26F3"
            "\u270A-\u270B"
            "\u2753-\u2755"
            "\u2795-\u2797"
            "\u2B1B-\u2B1C"
            "\U0001F191-\U0001F19A"
            "\U0001F232-\U0001F236"
            "\U0001F238-\U0001F23A"
            "\U0001F250-\U0001F251"
            "\U0001F300-\U0001F30C"
            "\U0001F30D-\U0001F30E"
            "\U0001F313-\U0001F315"
            "\U0001F316-\U0001F318"
            "\U0001F31D-\U0001F31E"
            "\U0001F31F-\U0001F320"
            "\U0001F32D-\U0001F32F"
            "\U0001F330-\U0001F331"
            "\U0001F332-\U0001F333"
            "\U0001F334-\U0001F335"
            "\U0001F337-\U0001F34A"
            "\U0001F34C-\U0001F34F"
            "\U0001F351-\U0001F37B"
            "\U0001F37E-\U0001F37F"
            "\U0001F380-\U0001F393"
            "\U0001F3A0-\U0001F3C4"
            "\U0001F3CF-\U0001F3D3"
            "\U0001F3E0-\U0001F3E3"
            "\U0001F3E5-\U0001F3F0"
            "\U0001F3F8-\U0001F407"
            "\U0001F409-\U0001F40B"
            "\U0001F40C-\U0001F40E"
            "\U0001F40F-\U0001F410"
            "\U0001F411-\U0001F412"
            "\U0001F417-\U0001F429"
            "\U0001F42B-\U0001F43E"
            "\U0001F442-\U0001F464"
            "\U0001F466-\U0001F46B"
            "\U0001F46C-\U0001F46D"
            "\U0001F46E-\U0001F4AC"
            "\U0001F4AE-\U0001F4B5"
            "\U0001F4B6-\U0001F4B7"
            "\U0001F4B8-\U0001F4EB"
            "\U0001F4EC-\U0001F4ED"
            "\U0001F4F0-\U0001F4F4"
            "\U0001F4F6-\U0001F4F7"
            "\U0001F4F9-\U0001F4FC"
            "\U0001F4FF-\U0001F502"
            "\U0001F504-\U0001F507"
            "\U0001F50A-\U0001F514"
            "\U0001F516-\U0001F52B"
            "\U0001F52C-\U0001F52D"
            "\U0001F52E-\U0001F53D"
            "\U0001F54B-\U0001F54E"
            "\U0001F550-\U0001F55B"
            "\U0001F55C-\U0001F567"
            "\U0001F595-\U0001F596"
            "\U0001F5FB-\U0001F5FF"
            "\U0001F601-\U0001F606"
            "\U0001F607-\U0001F608"
            "\U0001F609-\U0001F60D"
            "\U0001F612-\U0001F614"
            "\U0001F61C-\U0001F61E"
            "\U0001F620-\U0001F625"
            "\U0001F626-\U0001F627"
            "\U0001F628-\U0001F62B"
            "\U0001F62E-\U0001F62F"
            "\U0001F630-\U0001F633"
            "\U0001F637-\U0001F640"
            "\U0001F641-\U0001F644"
            "\U0001F645-\U0001F64F"
            "\U0001F681-\U0001F682"
            "\U0001F683-\U0001F685"
            "\U0001F68A-\U0001F68B"
            "\U0001F691-\U0001F693"
            "\U0001F699-\U0001F69A"
            "\U0001F69B-\U0001F6A1"
            "\U0001F6A4-\U0001F6A5"
            "\U0001F6A7-\U0001F6AD"
            "\U0001F6AE-\U0001F6B1"
            "\U0001F6B3-\U0001F6B5"
            "\U0001F6B7-\U0001F6B8"
            "\U0001F6B9-\U0001F6BE"
            "\U0001F6C1-\U0001F6C5"
            "\U0001F6D1-\U0001F6D2"
            "\U0001F6D6-\U0001F6D7"
            "\U0001F6DD-\U0001F6DF"
            "\U0001F6EB-\U0001F6EC"
            "\U0001F6F4-\U0001F6F6"
            "\U0001F6F7-\U0001F6F8"
            "\U0001F6FB-\U0001F6FC"
            "\U0001F7E0-\U0001F7EB"
            "\U0001F90D-\U0001F90F"
            "\U0001F910-\U0001F918"
            "\U0001F919-\U0001F91E"
            "\U0001F920-\U0001F927"
            "\U0001F928-\U0001F92F"
            "\U0001F931-\U0001F932"
            "\U0001F933-\U0001F93A"
            "\U0001F93C-\U0001F93E"
            "\U0001F940-\U0001F945"
            "\U0001F947-\U0001F94B"
            "\U0001F94D-\U0001F94F"
            "\U0001F950-\U0001F95E"
            "\U0001F95F-\U0001F96B"
            "\U0001F96C-\U0001F970"
            "\U0001F973-\U0001F976"
            "\U0001F977-\U0001F978"
            "\U0001F97C-\U0001F97F"
            "\U0001F980-\U0001F984"
            "\U0001F985-\U0001F991"
            "\U0001F992-\U0001F997"
            "\U0001F998-\U0001F9A2"
            "\U0001F9A3-\U0001F9A4"
            "\U0001F9A5-\U0001F9AA"
            "\U0001F9AB-\U0001F9AD"
            "\U0001F9AE-\U0001F9AF"
            "\U0001F9B0-\U0001F9B9"
            "\U0001F9BA-\U0001F9BF"
            "\U0001F9C1-\U0001F9C2"
            "\U0001F9C3-\U0001F9CA"
            "\U0001F9CD-\U0001F9CF"
            "\U0001F9D0-\U0001F9E6"
            "\U0001F9E7-\U0001F9FF"
            "\U0001FA70-\U0001FA73"
            "\U0001FA78-\U0001FA7A"
            "\U0001FA7B-\U0001FA7C"
            "\U0001FA80-\U0001FA82"
            "\U0001FA83-\U0001FA86"
            "\U0001FA90-\U0001FA95"
            "\U0001FA96-\U0001FAA8"
            "\U0001FAA9-\U0001FAAC"
            "\U0001FAB0-\U0001FAB6"
            "\U0001FAB7-\U0001FABA"
            "\U0001FAC0-\U0001FAC2"
            "\U0001FAC3-\U0001FAC5"
            "\U0001FAD0-\U0001FAD6"
            "\U0001FAD7-\U0001FAD9"
            "\U0001FAE0-\U0001FAE7"
            "\U0001FAF0-\U0001FAF6"
            "\u23F0"
            "\u23F3"
            "\u267F"
            "\u2693"
            "\u26A1"
            "\u26CE"
            "\u26D4"
            "\u26EA"
            "\u26F5"
            "\u26FA"
            "\u26FD"
            "\u2705"
            "\u2728"
            "\u274C"
            "\u274E"
            "\u2757"
            "\u27B0"
            "\u27BF"
            "\u2B50"
            "\u2B55"
            "\U0001F004"
            "\U0001F0CF"
            "\U0001F18E"
            "\U0001F201"
            "\U0001F21A"
            "\U0001F22F"
            "\U0001F30F"
            "\U0001F310"
            "\U0001F311"
            "\U0001F312"
            "\U0001F319"
            "\U0001F31A"
            "\U0001F31B"
            "\U0001F31C"
            "\U0001F34B"
            "\U0001F350"
            "\U0001F37C"
            "\U0001F3C5"
            "\U0001F3C6"
            "\U0001F3C7"
            "\U0001F3C8"
            "\U0001F3C9"
            "\U0001F3CA"
            "\U0001F3E4"
            "\U0001F3F4"
            "\U0001F408"
            "\U0001F413"
            "\U0001F414"
            "\U0001F415"
            "\U0001F416"
            "\U0001F42A"
            "\U0001F440"
            "\U0001F465"
            "\U0001F4AD"
            "\U0001F4EE"
            "\U0001F4EF"
            "\U0001F4F5"
            "\U0001F4F8"
            "\U0001F503"
            "\U0001F508"
            "\U0001F509"
            "\U0001F515"
            "\U0001F57A"
            "\U0001F5A4"
            "\U0001F600"
            "\U0001F60E"
            "\U0001F60F"
            "\U0001F610"
            "\U0001F611"
            "\U0001F615"
            "\U0001F616"
            "\U0001F617"
            "\U0001F618"
            "\U0001F619"
            "\U0001F61A"
            "\U0001F61B"
            "\U0001F61F"
            "\U0001F62C"
            "\U0001F62D"
            "\U0001F634"
            "\U0001F635"
            "\U0001F636"
            "\U0001F680"
            "\U0001F686"
            "\U0001F687"
            "\U0001F688"
            "\U0001F689"
            "\U0001F68C"
            "\U0001F68D"
            "\U0001F68E"
            "\U0001F68F"
            "\U0001F690"
            "\U0001F694"
            "\U0001F695"
            "\U0001F696"
            "\U0001F697"
            "\U0001F698"
            "\U0001F6A2"
            "\U0001F6A3"
            "\U0001F6A6"
            "\U0001F6B2"
            "\U0001F6B6"
            "\U0001F6BF"
            "\U0001F6C0"
            "\U0001F6CC"
            "\U0001F6D0"
            "\U0001F6D5"
            "\U0001F6F9"
            "\U0001F6FA"
            "\U0001F7F0"
            "\U0001F90C"
            "\U0001F91F"
            "\U0001F930"
            "\U0001F93F"
            "\U0001F94C"
            "\U0001F971"
            "\U0001F972"
            "\U0001F979"
            "\U0001F97A"
            "\U0001F97B"
            "\U0001F9C0"
            "\U0001F9CB"
            "\U0001F9CC"
            "\U0001FA74"
            "\u00A9"
            "\uFE0F"
            "\u00AE"
            "\uFE0F"
            "\u203C"
            "\uFE0F"
            "\u2049"
            "\uFE0F"
            "\u2122"
            "\uFE0F"
            "\u2139"
            "\uFE0F"
            "\u2194"
            "\uFE0F"
            "\u2195"
            "\uFE0F"
            "\u2196"
            "\uFE0F"
            "\u2197"
            "\uFE0F"
            "\u2198"
            "\uFE0F"
            "\u2199"
            "\uFE0F"
            "\u21A9"
            "\uFE0F"
            "\u21AA"
            "\uFE0F"
            "\u2328"
            "\uFE0F"
            "\u23CF"
            "\uFE0F"
            "\u23ED"
            "\uFE0F"
            "\u23EE"
            "\uFE0F"
            "\u23EF"
            "\uFE0F"
            "\u23F1"
            "\uFE0F"
            "\u23F2"
            "\uFE0F"
            "\u23F8"
            "\uFE0F"
            "\u23F9"
            "\uFE0F"
            "\u23FA"
            "\uFE0F"
            "\u24C2"
            "\uFE0F"
            "\u25AA"
            "\uFE0F"
            "\u25AB"
            "\uFE0F"
            "\u25B6"
            "\uFE0F"
            "\u25C0"
            "\uFE0F"
            "\u25FB"
            "\uFE0F"
            "\u25FC"
            "\uFE0F"
            "\u2600"
            "\uFE0F"
            "\u2601"
            "\uFE0F"
            "\u2602"
            "\uFE0F"
            "\u2603"
            "\uFE0F"
            "\u2604"
            "\uFE0F"
            "\u260E"
            "\uFE0F"
            "\u2611"
            "\uFE0F"
            "\u2618"
            "\uFE0F"
            "\u261D"
            "\uFE0F"
            "\u2620"
            "\uFE0F"
            "\u2622"
            "\uFE0F"
            "\u2623"
            "\uFE0F"
            "\u2626"
            "\uFE0F"
            "\u262A"
            "\uFE0F"
            "\u262E"
            "\uFE0F"
            "\u262F"
            "\uFE0F"
            "\u2638"
            "\uFE0F"
            "\u2639"
            "\uFE0F"
            "\u263A"
            "\uFE0F"
            "\u2640"
            "\uFE0F"
            "\u2642"
            "\uFE0F"
            "\u265F"
            "\uFE0F"
            "\u2660"
            "\uFE0F"
            "\u2663"
            "\uFE0F"
            "\u2665"
            "\uFE0F"
            "\u2666"
            "\uFE0F"
            "\u2668"
            "\uFE0F"
            "\u267B"
            "\uFE0F"
            "\u267E"
            "\uFE0F"
            "\u2692"
            "\uFE0F"
            "\u2694"
            "\uFE0F"
            "\u2695"
            "\uFE0F"
            "\u2696"
            "\uFE0F"
            "\u2697"
            "\uFE0F"
            "\u2699"
            "\uFE0F"
            "\u269B"
            "\uFE0F"
            "\u269C"
            "\uFE0F"
            "\u26A0"
            "\uFE0F"
            "\u26A7"
            "\uFE0F"
            "\u26B0"
            "\uFE0F"
            "\u26B1"
            "\uFE0F"
            "\u26C8"
            "\uFE0F"
            "\u26CF"
            "\uFE0F"
            "\u26D1"
            "\uFE0F"
            "\u26D3"
            "\uFE0F"
            "\u26E9"
            "\uFE0F"
            "\u26F0"
            "\uFE0F"
            "\u26F1"
            "\uFE0F"
            "\u26F4"
            "\uFE0F"
            "\u26F7"
            "\uFE0F"
            "\u26F8"
            "\uFE0F"
            "\u26F9"
            "\uFE0F"
            "\u2702"
            "\uFE0F"
            "\u2708"
            "\uFE0F"
            "\u2709"
            "\uFE0F"
            "\u270C"
            "\uFE0F"
            "\u270D"
            "\uFE0F"
            "\u270F"
            "\uFE0F"
            "\u2712"
            "\uFE0F"
            "\u2714"
            "\uFE0F"
            "\u2716"
            "\uFE0F"
            "\u271D"
            "\uFE0F"
            "\u2721"
            "\uFE0F"
            "\u2733"
            "\uFE0F"
            "\u2734"
            "\uFE0F"
            "\u2744"
            "\uFE0F"
            "\u2747"
            "\uFE0F"
            "\u2763"
            "\uFE0F"
            "\u2764"
            "\uFE0F"
            "\u27A1"
            "\uFE0F"
            "\u2934"
            "\uFE0F"
            "\u2935"
            "\uFE0F"
            "\u2B05"
            "\uFE0F"
            "\u2B06"
            "\uFE0F"
            "\u2B07"
            "\uFE0F"
            "\u3030"
            "\uFE0F"
            "\u303D"
            "\uFE0F"
            "\u3297"
            "\uFE0F"
            "\u3299"
            "\uFE0F"
            "\U0001F170"
            "\uFE0F"
            "\U0001F171"
            "\uFE0F"
            "\U0001F17E"
            "\uFE0F"
            "\U0001F17F"
            "\uFE0F"
            "\U0001F202"
            "\uFE0F"
            "\U0001F237"
            "\uFE0F"
            "\U0001F321"
            "\uFE0F"
            "\U0001F324"
            "\uFE0F"
            "\U0001F325"
            "\uFE0F"
            "\U0001F326"
            "\uFE0F"
            "\U0001F327"
            "\uFE0F"
            "\U0001F328"
            "\uFE0F"
            "\U0001F329"
            "\uFE0F"
            "\U0001F32A"
            "\uFE0F"
            "\U0001F32B"
            "\uFE0F"
            "\U0001F32C"
            "\uFE0F"
            "\U0001F336"
            "\uFE0F"
            "\U0001F37D"
            "\uFE0F"
            "\U0001F396"
            "\uFE0F"
            "\U0001F397"
            "\uFE0F"
            "\U0001F399"
            "\uFE0F"
            "\U0001F39A"
            "\uFE0F"
            "\U0001F39B"
            "\uFE0F"
            "\U0001F39E"
            "\uFE0F"
            "\U0001F39F"
            "\uFE0F"
            "\U0001F3CB"
            "\uFE0F"
            "\U0001F3CC"
            "\uFE0F"
            "\U0001F3CD"
            "\uFE0F"
            "\U0001F3CE"
            "\uFE0F"
            "\U0001F3D4"
            "\uFE0F"
            "\U0001F3D5"
            "\uFE0F"
            "\U0001F3D6"
            "\uFE0F"
            "\U0001F3D7"
            "\uFE0F"
            "\U0001F3D8"
            "\uFE0F"
            "\U0001F3D9"
            "\uFE0F"
            "\U0001F3DA"
            "\uFE0F"
            "\U0001F3DB"
            "\uFE0F"
            "\U0001F3DC"
            "\uFE0F"
            "\U0001F3DD"
            "\uFE0F"
            "\U0001F3DE"
            "\uFE0F"
            "\U0001F3DF"
            "\uFE0F"
            "\U0001F3F3"
            "\uFE0F"
            "\U0001F3F5"
            "\uFE0F"
            "\U0001F3F7"
            "\uFE0F"
            "\U0001F43F"
            "\uFE0F"
            "\U0001F441"
            "\uFE0F"
            "\U0001F4FD"
            "\uFE0F"
            "\U0001F549"
            "\uFE0F"
            "\U0001F54A"
            "\uFE0F"
            "\U0001F56F"
            "\uFE0F"
            "\U0001F570"
            "\uFE0F"
            "\U0001F573"
            "\uFE0F"
            "\U0001F574"
            "\uFE0F"
            "\U0001F575"
            "\uFE0F"
            "\U0001F576"
            "\uFE0F"
            "\U0001F577"
            "\uFE0F"
            "\U0001F578"
            "\uFE0F"
            "\U0001F579"
            "\uFE0F"
            "\U0001F587"
            "\uFE0F"
            "\U0001F58A"
            "\uFE0F"
            "\U0001F58B"
            "\uFE0F"
            "\U0001F58C"
            "\uFE0F"
            "\U0001F58D"
            "\uFE0F"
            "\U0001F590"
            "\uFE0F"
            "\U0001F5A5"
            "\uFE0F"
            "\U0001F5A8"
            "\uFE0F"
            "\U0001F5B1"
            "\uFE0F"
            "\U0001F5B2"
            "\uFE0F"
            "\U0001F5BC"
            "\uFE0F"
            "\U0001F5C2"
            "\uFE0F"
            "\U0001F5C3"
            "\uFE0F"
            "\U0001F5C4"
            "\uFE0F"
            "\U0001F5D1"
            "\uFE0F"
            "\U0001F5D2"
            "\uFE0F"
            "\U0001F5D3"
            "\uFE0F"
            "\U0001F5DC"
            "\uFE0F"
            "\U0001F5DD"
            "\uFE0F"
            "\U0001F5DE"
            "\uFE0F"
            "\U0001F5E1"
            "\uFE0F"
            "\U0001F5E3"
            "\uFE0F"
            "\U0001F5E8"
            "\uFE0F"
            "\U0001F5EF"
            "\uFE0F"
            "\U0001F5F3"
            "\uFE0F"
            "\U0001F5FA"
            "\uFE0F"
            "\U0001F6CB"
            "\uFE0F"
            "\U0001F6CD"
            "\uFE0F"
            "\U0001F6CE"
            "\uFE0F"
            "\U0001F6CF"
            "\uFE0F"
            "\U0001F6E0"
            "\uFE0F"
            "\U0001F6E1"
            "\uFE0F"
            "\U0001F6E2"
            "\uFE0F"
            "\U0001F6E3"
            "\uFE0F"
            "\U0001F6E4"
            "\uFE0F"
            "\U0001F6E5"
            "\uFE0F"
            "\U0001F6E9"
            "\uFE0F"
            "\U0001F6F0"
            "\uFE0F"
            "\U0001F6F3"
            "\uFE0F"
            "\u0023"
            "\uFE0F"
            "\u20E3"
            "\u002A"
            "\uFE0F"
            "\u20E3"
            "\u0030"
            "\uFE0F"
            "\u20E3"
            "\u0031"
            "\uFE0F"
            "\u20E3"
            "\u0032"
            "\uFE0F"
            "\u20E3"
            "\u0033"
            "\uFE0F"
            "\u20E3"
            "\u0034"
            "\uFE0F"
            "\u20E3"
            "\u0035"
            "\uFE0F"
            "\u20E3"
            "\u0036"
            "\uFE0F"
            "\u20E3"
            "\u0037"
            "\uFE0F"
            "\u20E3"
            "\u0038"
            "\uFE0F"
            "\u20E3"
            "\u0039"
            "\uFE0F"
            "\u20E3"
            "\U0001F1E6"
            "\U0001F1E8"
            "\U0001F1E6"
            "\U0001F1E9"
            "\U0001F1E6"
            "\U0001F1EA"
            "\U0001F1E6"
            "\U0001F1EB"
            "\U0001F1E6"
            "\U0001F1EC"
            "\U0001F1E6"
            "\U0001F1EE"
            "\U0001F1E6"
            "\U0001F1F1"
            "\U0001F1E6"
            "\U0001F1F2"
            "\U0001F1E6"
            "\U0001F1F4"
            "\U0001F1E6"
            "\U0001F1F6"
            "\U0001F1E6"
            "\U0001F1F7"
            "\U0001F1E6"
            "\U0001F1F8"
            "\U0001F1E6"
            "\U0001F1F9"
            "\U0001F1E6"
            "\U0001F1FA"
            "\U0001F1E6"
            "\U0001F1FC"
            "\U0001F1E6"
            "\U0001F1FD"
            "\U0001F1E6"
            "\U0001F1FF"
            "\U0001F1E7"
            "\U0001F1E6"
            "\U0001F1E7"
            "\U0001F1E7"
            "\U0001F1E7"
            "\U0001F1E9"
            "\U0001F1E7"
            "\U0001F1EA"
            "\U0001F1E7"
            "\U0001F1EB"
            "\U0001F1E7"
            "\U0001F1EC"
            "\U0001F1E7"
            "\U0001F1ED"
            "\U0001F1E7"
            "\U0001F1EE"
            "\U0001F1E7"
            "\U0001F1EF"
            "\U0001F1E7"
            "\U0001F1F1"
            "\U0001F1E7"
            "\U0001F1F2"
            "\U0001F1E7"
            "\U0001F1F3"
            "\U0001F1E7"
            "\U0001F1F4"
            "\U0001F1E7"
            "\U0001F1F6"
            "\U0001F1E7"
            "\U0001F1F7"
            "\U0001F1E7"
            "\U0001F1F8"
            "\U0001F1E7"
            "\U0001F1F9"
            "\U0001F1E7"
            "\U0001F1FB"
            "\U0001F1E7"
            "\U0001F1FC"
            "\U0001F1E7"
            "\U0001F1FE"
            "\U0001F1E7"
            "\U0001F1FF"
            "\U0001F1E8"
            "\U0001F1E6"
            "\U0001F1E8"
            "\U0001F1E8"
            "\U0001F1E8"
            "\U0001F1E9"
            "\U0001F1E8"
            "\U0001F1EB"
            "\U0001F1E8"
            "\U0001F1EC"
            "\U0001F1E8"
            "\U0001F1ED"
            "\U0001F1E8"
            "\U0001F1EE"
            "\U0001F1E8"
            "\U0001F1F0"
            "\U0001F1E8"
            "\U0001F1F1"
            "\U0001F1E8"
            "\U0001F1F2"
            "\U0001F1E8"
            "\U0001F1F3"
            "\U0001F1E8"
            "\U0001F1F4"
            "\U0001F1E8"
            "\U0001F1F5"
            "\U0001F1E8"
            "\U0001F1F7"
            "\U0001F1E8"
            "\U0001F1FA"
            "\U0001F1E8"
            "\U0001F1FB"
            "\U0001F1E8"
            "\U0001F1FC"
            "\U0001F1E8"
            "\U0001F1FD"
            "\U0001F1E8"
            "\U0001F1FE"
            "\U0001F1E8"
            "\U0001F1FF"
            "\U0001F1E9"
            "\U0001F1EA"
            "\U0001F1E9"
            "\U0001F1EC"
            "\U0001F1E9"
            "\U0001F1EF"
            "\U0001F1E9"
            "\U0001F1F0"
            "\U0001F1E9"
            "\U0001F1F2"
            "\U0001F1E9"
            "\U0001F1F4"
            "\U0001F1E9"
            "\U0001F1FF"
            "\U0001F1EA"
            "\U0001F1E6"
            "\U0001F1EA"
            "\U0001F1E8"
            "\U0001F1EA"
            "\U0001F1EA"
            "\U0001F1EA"
            "\U0001F1EC"
            "\U0001F1EA"
            "\U0001F1ED"
            "\U0001F1EA"
            "\U0001F1F7"
            "\U0001F1EA"
            "\U0001F1F8"
            "\U0001F1EA"
            "\U0001F1F9"
            "\U0001F1EA"
            "\U0001F1FA"
            "\U0001F1EB"
            "\U0001F1EE"
            "\U0001F1EB"
            "\U0001F1EF"
            "\U0001F1EB"
            "\U0001F1F0"
            "\U0001F1EB"
            "\U0001F1F2"
            "\U0001F1EB"
            "\U0001F1F4"
            "\U0001F1EB"
            "\U0001F1F7"
            "\U0001F1EC"
            "\U0001F1E6"
            "\U0001F1EC"
            "\U0001F1E7"
            "\U0001F1EC"
            "\U0001F1E9"
            "\U0001F1EC"
            "\U0001F1EA"
            "\U0001F1EC"
            "\U0001F1EB"
            "\U0001F1EC"
            "\U0001F1EC"
            "\U0001F1EC"
            "\U0001F1ED"
            "\U0001F1EC"
            "\U0001F1EE"
            "\U0001F1EC"
            "\U0001F1F1"
            "\U0001F1EC"
            "\U0001F1F2"
            "\U0001F1EC"
            "\U0001F1F3"
            "\U0001F1EC"
            "\U0001F1F5"
            "\U0001F1EC"
            "\U0001F1F6"
            "\U0001F1EC"
            "\U0001F1F7"
            "\U0001F1EC"
            "\U0001F1F8"
            "\U0001F1EC"
            "\U0001F1F9"
            "\U0001F1EC"
            "\U0001F1FA"
            "\U0001F1EC"
            "\U0001F1FC"
            "\U0001F1EC"
            "\U0001F1FE"
            "\U0001F1ED"
            "\U0001F1F0"
            "\U0001F1ED"
            "\U0001F1F2"
            "\U0001F1ED"
            "\U0001F1F3"
            "\U0001F1ED"
            "\U0001F1F7"
            "\U0001F1ED"
            "\U0001F1F9"
            "\U0001F1ED"
            "\U0001F1FA"
            "\U0001F1EE"
            "\U0001F1E8"
            "\U0001F1EE"
            "\U0001F1E9"
            "\U0001F1EE"
            "\U0001F1EA"
            "\U0001F1EE"
            "\U0001F1F1"
            "\U0001F1EE"
            "\U0001F1F2"
            "\U0001F1EE"
            "\U0001F1F3"
            "\U0001F1EE"
            "\U0001F1F4"
            "\U0001F1EE"
            "\U0001F1F6"
            "\U0001F1EE"
            "\U0001F1F7"
            "\U0001F1EE"
            "\U0001F1F8"
            "\U0001F1EE"
            "\U0001F1F9"
            "\U0001F1EF"
            "\U0001F1EA"
            "\U0001F1EF"
            "\U0001F1F2"
            "\U0001F1EF"
            "\U0001F1F4"
            "\U0001F1EF"
            "\U0001F1F5"
            "\U0001F1F0"
            "\U0001F1EA"
            "\U0001F1F0"
            "\U0001F1EC"
            "\U0001F1F0"
            "\U0001F1ED"
            "\U0001F1F0"
            "\U0001F1EE"
            "\U0001F1F0"
            "\U0001F1F2"
            "\U0001F1F0"
            "\U0001F1F3"
            "\U0001F1F0"
            "\U0001F1F5"
            "\U0001F1F0"
            "\U0001F1F7"
            "\U0001F1F0"
            "\U0001F1FC"
            "\U0001F1F0"
            "\U0001F1FE"
            "\U0001F1F0"
            "\U0001F1FF"
            "\U0001F1F1"
            "\U0001F1E6"
            "\U0001F1F1"
            "\U0001F1E7"
            "\U0001F1F1"
            "\U0001F1E8"
            "\U0001F1F1"
            "\U0001F1EE"
            "\U0001F1F1"
            "\U0001F1F0"
            "\U0001F1F1"
            "\U0001F1F7"
            "\U0001F1F1"
            "\U0001F1F8"
            "\U0001F1F1"
            "\U0001F1F9"
            "\U0001F1F1"
            "\U0001F1FA"
            "\U0001F1F1"
            "\U0001F1FB"
            "\U0001F1F1"
            "\U0001F1FE"
            "\U0001F1F2"
            "\U0001F1E6"
            "\U0001F1F2"
            "\U0001F1E8"
            "\U0001F1F2"
            "\U0001F1E9"
            "\U0001F1F2"
            "\U0001F1EA"
            "\U0001F1F2"
            "\U0001F1EB"
            "\U0001F1F2"
            "\U0001F1EC"
            "\U0001F1F2"
            "\U0001F1ED"
            "\U0001F1F2"
            "\U0001F1F0"
            "\U0001F1F2"
            "\U0001F1F1"
            "\U0001F1F2"
            "\U0001F1F2"
            "\U0001F1F2"
            "\U0001F1F3"
            "\U0001F1F2"
            "\U0001F1F4"
            "\U0001F1F2"
            "\U0001F1F5"
            "\U0001F1F2"
            "\U0001F1F6"
            "\U0001F1F2"
            "\U0001F1F7"
            "\U0001F1F2"
            "\U0001F1F8"
            "\U0001F1F2"
            "\U0001F1F9"
            "\U0001F1F2"
            "\U0001F1FA"
            "\U0001F1F2"
            "\U0001F1FB"
            "\U0001F1F2"
            "\U0001F1FC"
            "\U0001F1F2"
            "\U0001F1FD"
            "\U0001F1F2"
            "\U0001F1FE"
            "\U0001F1F2"
            "\U0001F1FF"
            "\U0001F1F3"
            "\U0001F1E6"
            "\U0001F1F3"
            "\U0001F1E8"
            "\U0001F1F3"
            "\U0001F1EA"
            "\U0001F1F3"
            "\U0001F1EB"
            "\U0001F1F3"
            "\U0001F1EC"
            "\U0001F1F3"
            "\U0001F1EE"
            "\U0001F1F3"
            "\U0001F1F1"
            "\U0001F1F3"
            "\U0001F1F4"
            "\U0001F1F3"
            "\U0001F1F5"
            "\U0001F1F3"
            "\U0001F1F7"
            "\U0001F1F3"
            "\U0001F1FA"
            "\U0001F1F3"
            "\U0001F1FF"
            "\U0001F1F4"
            "\U0001F1F2"
            "\U0001F1F5"
            "\U0001F1E6"
            "\U0001F1F5"
            "\U0001F1EA"
            "\U0001F1F5"
            "\U0001F1EB"
            "\U0001F1F5"
            "\U0001F1EC"
            "\U0001F1F5"
            "\U0001F1ED"
            "\U0001F1F5"
            "\U0001F1F0"
            "\U0001F1F5"
            "\U0001F1F1"
            "\U0001F1F5"
            "\U0001F1F2"
            "\U0001F1F5"
            "\U0001F1F3"
            "\U0001F1F5"
            "\U0001F1F7"
            "\U0001F1F5"
            "\U0001F1F8"
            "\U0001F1F5"
            "\U0001F1F9"
            "\U0001F1F5"
            "\U0001F1FC"
            "\U0001F1F5"
            "\U0001F1FE"
            "\U0001F1F6"
            "\U0001F1E6"
            "\U0001F1F7"
            "\U0001F1EA"
            "\U0001F1F7"
            "\U0001F1F4"
            "\U0001F1F7"
            "\U0001F1F8"
            "\U0001F1F7"
            "\U0001F1FA"
            "\U0001F1F7"
            "\U0001F1FC"
            "\U0001F1F8"
            "\U0001F1E6"
            "\U0001F1F8"
            "\U0001F1E7"
            "\U0001F1F8"
            "\U0001F1E8"
            "\U0001F1F8"
            "\U0001F1E9"
            "\U0001F1F8"
            "\U0001F1EA"
            "\U0001F1F8"
            "\U0001F1EC"
            "\U0001F1F8"
            "\U0001F1ED"
            "\U0001F1F8"
            "\U0001F1EE"
            "\U0001F1F8"
            "\U0001F1EF"
            "\U0001F1F8"
            "\U0001F1F0"
            "\U0001F1F8"
            "\U0001F1F1"
            "\U0001F1F8"
            "\U0001F1F2"
            "\U0001F1F8"
            "\U0001F1F3"
            "\U0001F1F8"
            "\U0001F1F4"
            "\U0001F1F8"
            "\U0001F1F7"
            "\U0001F1F8"
            "\U0001F1F8"
            "\U0001F1F8"
            "\U0001F1F9"
            "\U0001F1F8"
            "\U0001F1FB"
            "\U0001F1F8"
            "\U0001F1FD"
            "\U0001F1F8"
            "\U0001F1FE"
            "\U0001F1F8"
            "\U0001F1FF"
            "\U0001F1F9"
            "\U0001F1E6"
            "\U0001F1F9"
            "\U0001F1E8"
            "\U0001F1F9"
            "\U0001F1E9"
            "\U0001F1F9"
            "\U0001F1EB"
            "\U0001F1F9"
            "\U0001F1EC"
            "\U0001F1F9"
            "\U0001F1ED"
            "\U0001F1F9"
            "\U0001F1EF"
            "\U0001F1F9"
            "\U0001F1F0"
            "\U0001F1F9"
            "\U0001F1F1"
            "\U0001F1F9"
            "\U0001F1F2"
            "\U0001F1F9"
            "\U0001F1F3"
            "\U0001F1F9"
            "\U0001F1F4"
            "\U0001F1F9"
            "\U0001F1F7"
            "\U0001F1F9"
            "\U0001F1F9"
            "\U0001F1F9"
            "\U0001F1FB"
            "\U0001F1F9"
            "\U0001F1FC"
            "\U0001F1F9"
            "\U0001F1FF"
            "\U0001F1FA"
            "\U0001F1E6"
            "\U0001F1FA"
            "\U0001F1EC"
            "\U0001F1FA"
            "\U0001F1F2"
            "\U0001F1FA"
            "\U0001F1F3"
            "\U0001F1FA"
            "\U0001F1F8"
            "\U0001F1FA"
            "\U0001F1FE"
            "\U0001F1FA"
            "\U0001F1FF"
            "\U0001F1FB"
            "\U0001F1E6"
            "\U0001F1FB"
            "\U0001F1E8"
            "\U0001F1FB"
            "\U0001F1EA"
            "\U0001F1FB"
            "\U0001F1EC"
            "\U0001F1FB"
            "\U0001F1EE"
            "\U0001F1FB"
            "\U0001F1F3"
            "\U0001F1FB"
            "\U0001F1FA"
            "\U0001F1FC"
            "\U0001F1EB"
            "\U0001F1FC"
            "\U0001F1F8"
            "\U0001F1FD"
            "\U0001F1F0"
            "\U0001F1FE"
            "\U0001F1EA"
            "\U0001F1FE"
            "\U0001F1F9"
            "\U0001F1FF"
            "\U0001F1E6"
            "\U0001F1FF"
            "\U0001F1F2"
            "\U0001F1FF"
            "\U0001F1FC"
            "\U0001F3F4"
            "\U000E0067"
            "\U000E0062"
            "\U000E0065"
            "\U000E006E"
            "\U000E0067"
            "\U000E007F"
            "\U0001F3F4"
            "\U000E0067"
            "\U000E0062"
            "\U000E0073"
            "\U000E0063"
            "\U000E0074"
            "\U000E007F"
            "\U0001F3F4"
            "\U000E0067"
            "\U000E0062"
            "\U000E0077"
            "\U000E006C"
            "\U000E0073"
            "\U000E007F"
            "\u261D"
            "\U0001F3FB"
            "\u261D"
            "\U0001F3FC"
            "\u261D"
            "\U0001F3FD"
            "\u261D"
            "\U0001F3FE"
            "\u261D"
            "\U0001F3FF"
            "\u26F9"
            "\U0001F3FB"
            "\u26F9"
            "\U0001F3FC"
            "\u26F9"
            "\U0001F3FD"
            "\u26F9"
            "\U0001F3FE"
            "\u26F9"
            "\U0001F3FF"
            "\u270A"
            "\U0001F3FB"
            "\u270A"
            "\U0001F3FC"
            "\u270A"
            "\U0001F3FD"
            "\u270A"
            "\U0001F3FE"
            "\u270A"
            "\U0001F3FF"
            "\u270B"
            "\U0001F3FB"
            "\u270B"
            "\U0001F3FC"
            "\u270B"
            "\U0001F3FD"
            "\u270B"
            "\U0001F3FE"
            "\u270B"
            "\U0001F3FF"
            "\u270C"
            "\U0001F3FB"
            "\u270C"
            "\U0001F3FC"
            "\u270C"
            "\U0001F3FD"
            "\u270C"
            "\U0001F3FE"
            "\u270C"
            "\U0001F3FF"
            "\u270D"
            "\U0001F3FB"
            "\u270D"
            "\U0001F3FC"
            "\u270D"
            "\U0001F3FD"
            "\u270D"
            "\U0001F3FE"
            "\u270D"
            "\U0001F3FF"
            "\U0001F385"
            "\U0001F3FB"
            "\U0001F385"
            "\U0001F3FC"
            "\U0001F385"
            "\U0001F3FD"
            "\U0001F385"
            "\U0001F3FE"
            "\U0001F385"
            "\U0001F3FF"
            "\U0001F3C2"
            "\U0001F3FB"
            "\U0001F3C2"
            "\U0001F3FC"
            "\U0001F3C2"
            "\U0001F3FD"
            "\U0001F3C2"
            "\U0001F3FE"
            "\U0001F3C2"
            "\U0001F3FF"
            "\U0001F3C3"
            "\U0001F3FB"
            "\U0001F3C3"
            "\U0001F3FC"
            "\U0001F3C3"
            "\U0001F3FD"
            "\U0001F3C3"
            "\U0001F3FE"
            "\U0001F3C3"
            "\U0001F3FF"
            "\U0001F3C4"
            "\U0001F3FB"
            "\U0001F3C4"
            "\U0001F3FC"
            "\U0001F3C4"
            "\U0001F3FD"
            "\U0001F3C4"
            "\U0001F3FE"
            "\U0001F3C4"
            "\U0001F3FF"
            "\U0001F3C7"
            "\U0001F3FB"
            "\U0001F3C7"
            "\U0001F3FC"
            "\U0001F3C7"
            "\U0001F3FD"
            "\U0001F3C7"
            "\U0001F3FE"
            "\U0001F3C7"
            "\U0001F3FF"
            "\U0001F3CA"
            "\U0001F3FB"
            "\U0001F3CA"
            "\U0001F3FC"
            "\U0001F3CA"
            "\U0001F3FD"
            "\U0001F3CA"
            "\U0001F3FE"
            "\U0001F3CA"
            "\U0001F3FF"
            "\U0001F3CB"
            "\U0001F3FB"
            "\U0001F3CB"
            "\U0001F3FC"
            "\U0001F3CB"
            "\U0001F3FD"
            "\U0001F3CB"
            "\U0001F3FE"
            "\U0001F3CB"
            "\U0001F3FF"
            "\U0001F3CC"
            "\U0001F3FB"
            "\U0001F3CC"
            "\U0001F3FC"
            "\U0001F3CC"
            "\U0001F3FD"
            "\U0001F3CC"
            "\U0001F3FE"
            "\U0001F3CC"
            "\U0001F3FF"
            "\U0001F442"
            "\U0001F3FB"
            "\U0001F442"
            "\U0001F3FC"
            "\U0001F442"
            "\U0001F3FD"
            "\U0001F442"
            "\U0001F3FE"
            "\U0001F442"
            "\U0001F3FF"
            "\U0001F443"
            "\U0001F3FB"
            "\U0001F443"
            "\U0001F3FC"
            "\U0001F443"
            "\U0001F3FD"
            "\U0001F443"
            "\U0001F3FE"
            "\U0001F443"
            "\U0001F3FF"
            "\U0001F446"
            "\U0001F3FB"
            "\U0001F446"
            "\U0001F3FC"
            "\U0001F446"
            "\U0001F3FD"
            "\U0001F446"
            "\U0001F3FE"
            "\U0001F446"
            "\U0001F3FF"
            "\U0001F447"
            "\U0001F3FB"
            "\U0001F447"
            "\U0001F3FC"
            "\U0001F447"
            "\U0001F3FD"
            "\U0001F447"
            "\U0001F3FE"
            "\U0001F447"
            "\U0001F3FF"
            "\U0001F448"
            "\U0001F3FB"
            "\U0001F448"
            "\U0001F3FC"
            "\U0001F448"
            "\U0001F3FD"
            "\U0001F448"
            "\U0001F3FE"
            "\U0001F448"
            "\U0001F3FF"
            "\U0001F449"
            "\U0001F3FB"
            "\U0001F449"
            "\U0001F3FC"
            "\U0001F449"
            "\U0001F3FD"
            "\U0001F449"
            "\U0001F3FE"
            "\U0001F449"
            "\U0001F3FF"
            "\U0001F44A"
            "\U0001F3FB"
            "\U0001F44A"
            "\U0001F3FC"
            "\U0001F44A"
            "\U0001F3FD"
            "\U0001F44A"
            "\U0001F3FE"
            "\U0001F44A"
            "\U0001F3FF"
            "\U0001F44B"
            "\U0001F3FB"
            "\U0001F44B"
            "\U0001F3FC"
            "\U0001F44B"
            "\U0001F3FD"
            "\U0001F44B"
            "\U0001F3FE"
            "\U0001F44B"
            "\U0001F3FF"
            "\U0001F44C"
            "\U0001F3FB"
            "\U0001F44C"
            "\U0001F3FC"
            "\U0001F44C"
            "\U0001F3FD"
            "\U0001F44C"
            "\U0001F3FE"
            "\U0001F44C"
            "\U0001F3FF"
            "\U0001F44D"
            "\U0001F3FB"
            "\U0001F44D"
            "\U0001F3FC"
            "\U0001F44D"
            "\U0001F3FD"
            "\U0001F44D"
            "\U0001F3FE"
            "\U0001F44D"
            "\U0001F3FF"
            "\U0001F44E"
            "\U0001F3FB"
            "\U0001F44E"
            "\U0001F3FC"
            "\U0001F44E"
            "\U0001F3FD"
            "\U0001F44E"
            "\U0001F3FE"
            "\U0001F44E"
            "\U0001F3FF"
            "\U0001F44F"
            "\U0001F3FB"
            "\U0001F44F"
            "\U0001F3FC"
            "\U0001F44F"
            "\U0001F3FD"
            "\U0001F44F"
            "\U0001F3FE"
            "\U0001F44F"
            "\U0001F3FF"
            "\U0001F450"
            "\U0001F3FB"
            "\U0001F450"
            "\U0001F3FC"
            "\U0001F450"
            "\U0001F3FD"
            "\U0001F450"
            "\U0001F3FE"
            "\U0001F450"
            "\U0001F3FF"
            "\U0001F466"
            "\U0001F3FB"
            "\U0001F466"
            "\U0001F3FC"
            "\U0001F466"
            "\U0001F3FD"
            "\U0001F466"
            "\U0001F3FE"
            "\U0001F466"
            "\U0001F3FF"
            "\U0001F467"
            "\U0001F3FB"
            "\U0001F467"
            "\U0001F3FC"
            "\U0001F467"
            "\U0001F3FD"
            "\U0001F467"
            "\U0001F3FE"
            "\U0001F467"
            "\U0001F3FF"
            "\U0001F468"
            "\U0001F3FB"
            "\U0001F468"
            "\U0001F3FC"
            "\U0001F468"
            "\U0001F3FD"
            "\U0001F468"
            "\U0001F3FE"
            "\U0001F468"
            "\U0001F3FF"
            "\U0001F469"
            "\U0001F3FB"
            "\U0001F469"
            "\U0001F3FC"
            "\U0001F469"
            "\U0001F3FD"
            "\U0001F469"
            "\U0001F3FE"
            "\U0001F469"
            "\U0001F3FF"
            "\U0001F46B"
            "\U0001F3FB"
            "\U0001F46B"
            "\U0001F3FC"
            "\U0001F46B"
            "\U0001F3FD"
            "\U0001F46B"
            "\U0001F3FE"
            "\U0001F46B"
            "\U0001F3FF"
            "\U0001F46C"
            "\U0001F3FB"
            "\U0001F46C"
            "\U0001F3FC"
            "\U0001F46C"
            "\U0001F3FD"
            "\U0001F46C"
            "\U0001F3FE"
            "\U0001F46C"
            "\U0001F3FF"
            "\U0001F46D"
            "\U0001F3FB"
            "\U0001F46D"
            "\U0001F3FC"
            "\U0001F46D"
            "\U0001F3FD"
            "\U0001F46D"
            "\U0001F3FE"
            "\U0001F46D"
            "\U0001F3FF"
            "\U0001F46E"
            "\U0001F3FB"
            "\U0001F46E"
            "\U0001F3FC"
            "\U0001F46E"
            "\U0001F3FD"
            "\U0001F46E"
            "\U0001F3FE"
            "\U0001F46E"
            "\U0001F3FF"
            "\U0001F470"
            "\U0001F3FB"
            "\U0001F470"
            "\U0001F3FC"
            "\U0001F470"
            "\U0001F3FD"
            "\U0001F470"
            "\U0001F3FE"
            "\U0001F470"
            "\U0001F3FF"
            "\U0001F471"
            "\U0001F3FB"
            "\U0001F471"
            "\U0001F3FC"
            "\U0001F471"
            "\U0001F3FD"
            "\U0001F471"
            "\U0001F3FE"
            "\U0001F471"
            "\U0001F3FF"
            "\U0001F472"
            "\U0001F3FB"
            "\U0001F472"
            "\U0001F3FC"
            "\U0001F472"
            "\U0001F3FD"
            "\U0001F472"
            "\U0001F3FE"
            "\U0001F472"
            "\U0001F3FF"
            "\U0001F473"
            "\U0001F3FB"
            "\U0001F473"
            "\U0001F3FC"
            "\U0001F473"
            "\U0001F3FD"
            "\U0001F473"
            "\U0001F3FE"
            "\U0001F473"
            "\U0001F3FF"
            "\U0001F474"
            "\U0001F3FB"
            "\U0001F474"
            "\U0001F3FC"
            "\U0001F474"
            "\U0001F3FD"
            "\U0001F474"
            "\U0001F3FE"
            "\U0001F474"
            "\U0001F3FF"
            "\U0001F475"
            "\U0001F3FB"
            "\U0001F475"
            "\U0001F3FC"
            "\U0001F475"
            "\U0001F3FD"
            "\U0001F475"
            "\U0001F3FE"
            "\U0001F475"
            "\U0001F3FF"
            "\U0001F476"
            "\U0001F3FB"
            "\U0001F476"
            "\U0001F3FC"
            "\U0001F476"
            "\U0001F3FD"
            "\U0001F476"
            "\U0001F3FE"
            "\U0001F476"
            "\U0001F3FF"
            "\U0001F477"
            "\U0001F3FB"
            "\U0001F477"
            "\U0001F3FC"
            "\U0001F477"
            "\U0001F3FD"
            "\U0001F477"
            "\U0001F3FE"
            "\U0001F477"
            "\U0001F3FF"
            "\U0001F478"
            "\U0001F3FB"
            "\U0001F478"
            "\U0001F3FC"
            "\U0001F478"
            "\U0001F3FD"
            "\U0001F478"
            "\U0001F3FE"
            "\U0001F478"
            "\U0001F3FF"
            "\U0001F47C"
            "\U0001F3FB"
            "\U0001F47C"
            "\U0001F3FC"
            "\U0001F47C"
            "\U0001F3FD"
            "\U0001F47C"
            "\U0001F3FE"
            "\U0001F47C"
            "\U0001F3FF"
            "\U0001F481"
            "\U0001F3FB"
            "\U0001F481"
            "\U0001F3FC"
            "\U0001F481"
            "\U0001F3FD"
            "\U0001F481"
            "\U0001F3FE"
            "\U0001F481"
            "\U0001F3FF"
            "\U0001F482"
            "\U0001F3FB"
            "\U0001F482"
            "\U0001F3FC"
            "\U0001F482"
            "\U0001F3FD"
            "\U0001F482"
            "\U0001F3FE"
            "\U0001F482"
            "\U0001F3FF"
            "\U0001F483"
            "\U0001F3FB"
            "\U0001F483"
            "\U0001F3FC"
            "\U0001F483"
            "\U0001F3FD"
            "\U0001F483"
            "\U0001F3FE"
            "\U0001F483"
            "\U0001F3FF"
            "\U0001F485"
            "\U0001F3FB"
            "\U0001F485"
            "\U0001F3FC"
            "\U0001F485"
            "\U0001F3FD"
            "\U0001F485"
            "\U0001F3FE"
            "\U0001F485"
            "\U0001F3FF"
            "\U0001F486"
            "\U0001F3FB"
            "\U0001F486"
            "\U0001F3FC"
            "\U0001F486"
            "\U0001F3FD"
            "\U0001F486"
            "\U0001F3FE"
            "\U0001F486"
            "\U0001F3FF"
            "\U0001F487"
            "\U0001F3FB"
            "\U0001F487"
            "\U0001F3FC"
            "\U0001F487"
            "\U0001F3FD"
            "\U0001F487"
            "\U0001F3FE"
            "\U0001F487"
            "\U0001F3FF"
            "\U0001F48F"
            "\U0001F3FB"
            "\U0001F48F"
            "\U0001F3FC"
            "\U0001F48F"
            "\U0001F3FD"
            "\U0001F48F"
            "\U0001F3FE"
            "\U0001F48F"
            "\U0001F3FF"
            "\U0001F491"
            "\U0001F3FB"
            "\U0001F491"
            "\U0001F3FC"
            "\U0001F491"
            "\U0001F3FD"
            "\U0001F491"
            "\U0001F3FE"
            "\U0001F491"
            "\U0001F3FF"
            "\U0001F4AA"
            "\U0001F3FB"
            "\U0001F4AA"
            "\U0001F3FC"
            "\U0001F4AA"
            "\U0001F3FD"
            "\U0001F4AA"
            "\U0001F3FE"
            "\U0001F4AA"
            "\U0001F3FF"
            "\U0001F574"
            "\U0001F3FB"
            "\U0001F574"
            "\U0001F3FC"
            "\U0001F574"
            "\U0001F3FD"
            "\U0001F574"
            "\U0001F3FE"
            "\U0001F574"
            "\U0001F3FF"
            "\U0001F575"
            "\U0001F3FB"
            "\U0001F575"
            "\U0001F3FC"
            "\U0001F575"
            "\U0001F3FD"
            "\U0001F575"
            "\U0001F3FE"
            "\U0001F575"
            "\U0001F3FF"
            "\U0001F57A"
            "\U0001F3FB"
            "\U0001F57A"
            "\U0001F3FC"
            "\U0001F57A"
            "\U0001F3FD"
            "\U0001F57A"
            "\U0001F3FE"
            "\U0001F57A"
            "\U0001F3FF"
            "\U0001F590"
            "\U0001F3FB"
            "\U0001F590"
            "\U0001F3FC"
            "\U0001F590"
            "\U0001F3FD"
            "\U0001F590"
            "\U0001F3FE"
            "\U0001F590"
            "\U0001F3FF"
            "\U0001F595"
            "\U0001F3FB"
            "\U0001F595"
            "\U0001F3FC"
            "\U0001F595"
            "\U0001F3FD"
            "\U0001F595"
            "\U0001F3FE"
            "\U0001F595"
            "\U0001F3FF"
            "\U0001F596"
            "\U0001F3FB"
            "\U0001F596"
            "\U0001F3FC"
            "\U0001F596"
            "\U0001F3FD"
            "\U0001F596"
            "\U0001F3FE"
            "\U0001F596"
            "\U0001F3FF"
            "\U0001F645"
            "\U0001F3FB"
            "\U0001F645"
            "\U0001F3FC"
            "\U0001F645"
            "\U0001F3FD"
            "\U0001F645"
            "\U0001F3FE"
            "\U0001F645"
            "\U0001F3FF"
            "\U0001F646"
            "\U0001F3FB"
            "\U0001F646"
            "\U0001F3FC"
            "\U0001F646"
            "\U0001F3FD"
            "\U0001F646"
            "\U0001F3FE"
            "\U0001F646"
            "\U0001F3FF"
            "\U0001F647"
            "\U0001F3FB"
            "\U0001F647"
            "\U0001F3FC"
            "\U0001F647"
            "\U0001F3FD"
            "\U0001F647"
            "\U0001F3FE"
            "\U0001F647"
            "\U0001F3FF"
            "\U0001F64B"
            "\U0001F3FB"
            "\U0001F64B"
            "\U0001F3FC"
            "\U0001F64B"
            "\U0001F3FD"
            "\U0001F64B"
            "\U0001F3FE"
            "\U0001F64B"
            "\U0001F3FF"
            "\U0001F64C"
            "\U0001F3FB"
            "\U0001F64C"
            "\U0001F3FC"
            "\U0001F64C"
            "\U0001F3FD"
            "\U0001F64C"
            "\U0001F3FE"
            "\U0001F64C"
            "\U0001F3FF"
            "\U0001F64D"
            "\U0001F3FB"
            "\U0001F64D"
            "\U0001F3FC"
            "\U0001F64D"
            "\U0001F3FD"
            "\U0001F64D"
            "\U0001F3FE"
            "\U0001F64D"
            "\U0001F3FF"
            "\U0001F64E"
            "\U0001F3FB"
            "\U0001F64E"
            "\U0001F3FC"
            "\U0001F64E"
            "\U0001F3FD"
            "\U0001F64E"
            "\U0001F3FE"
            "\U0001F64E"
            "\U0001F3FF"
            "\U0001F64F"
            "\U0001F3FB"
            "\U0001F64F"
            "\U0001F3FC"
            "\U0001F64F"
            "\U0001F3FD"
            "\U0001F64F"
            "\U0001F3FE"
            "\U0001F64F"
            "\U0001F3FF"
            "\U0001F6A3"
            "\U0001F3FB"
            "\U0001F6A3"
            "\U0001F3FC"
            "\U0001F6A3"
            "\U0001F3FD"
            "\U0001F6A3"
            "\U0001F3FE"
            "\U0001F6A3"
            "\U0001F3FF"
            "\U0001F6B4"
            "\U0001F3FB"
            "\U0001F6B4"
            "\U0001F3FC"
            "\U0001F6B4"
            "\U0001F3FD"
            "\U0001F6B4"
            "\U0001F3FE"
            "\U0001F6B4"
            "\U0001F3FF"
            "\U0001F6B5"
            "\U0001F3FB"
            "\U0001F6B5"
            "\U0001F3FC"
            "\U0001F6B5"
            "\U0001F3FD"
            "\U0001F6B5"
            "\U0001F3FE"
            "\U0001F6B5"
            "\U0001F3FF"
            "\U0001F6B6"
            "\U0001F3FB"
            "\U0001F6B6"
            "\U0001F3FC"
            "\U0001F6B6"
            "\U0001F3FD"
            "\U0001F6B6"
            "\U0001F3FE"
            "\U0001F6B6"
            "\U0001F3FF"
            "\U0001F6C0"
            "\U0001F3FB"
            "\U0001F6C0"
            "\U0001F3FC"
            "\U0001F6C0"
            "\U0001F3FD"
            "\U0001F6C0"
            "\U0001F3FE"
            "\U0001F6C0"
            "\U0001F3FF"
            "\U0001F6CC"
            "\U0001F3FB"
            "\U0001F6CC"
            "\U0001F3FC"
            "\U0001F6CC"
            "\U0001F3FD"
            "\U0001F6CC"
            "\U0001F3FE"
            "\U0001F6CC"
            "\U0001F3FF"
            "\U0001F90C"
            "\U0001F3FB"
            "\U0001F90C"
            "\U0001F3FC"
            "\U0001F90C"
            "\U0001F3FD"
            "\U0001F90C"
            "\U0001F3FE"
            "\U0001F90C"
            "\U0001F3FF"
            "\U0001F90F"
            "\U0001F3FB"
            "\U0001F90F"
            "\U0001F3FC"
            "\U0001F90F"
            "\U0001F3FD"
            "\U0001F90F"
            "\U0001F3FE"
            "\U0001F90F"
            "\U0001F3FF"
            "\U0001F918"
            "\U0001F3FB"
            "\U0001F918"
            "\U0001F3FC"
            "\U0001F918"
            "\U0001F3FD"
            "\U0001F918"
            "\U0001F3FE"
            "\U0001F918"
            "\U0001F3FF"
            "\U0001F919"
            "\U0001F3FB"
            "\U0001F919"
            "\U0001F3FC"
            "\U0001F919"
            "\U0001F3FD"
            "\U0001F919"
            "\U0001F3FE"
            "\U0001F919"
            "\U0001F3FF"
            "\U0001F91A"
            "\U0001F3FB"
            "\U0001F91A"
            "\U0001F3FC"
            "\U0001F91A"
            "\U0001F3FD"
            "\U0001F91A"
            "\U0001F3FE"
            "\U0001F91A"
            "\U0001F3FF"
            "\U0001F91B"
            "\U0001F3FB"
            "\U0001F91B"
            "\U0001F3FC"
            "\U0001F91B"
            "\U0001F3FD"
            "\U0001F91B"
            "\U0001F3FE"
            "\U0001F91B"
            "\U0001F3FF"
            "\U0001F91C"
            "\U0001F3FB"
            "\U0001F91C"
            "\U0001F3FC"
            "\U0001F91C"
            "\U0001F3FD"
            "\U0001F91C"
            "\U0001F3FE"
            "\U0001F91C"
            "\U0001F3FF"
            "\U0001F91D"
            "\U0001F3FB"
            "\U0001F91D"
            "\U0001F3FC"
            "\U0001F91D"
            "\U0001F3FD"
            "\U0001F91D"
            "\U0001F3FE"
            "\U0001F91D"
            "\U0001F3FF"
            "\U0001F91E"
            "\U0001F3FB"
            "\U0001F91E"
            "\U0001F3FC"
            "\U0001F91E"
            "\U0001F3FD"
            "\U0001F91E"
            "\U0001F3FE"
            "\U0001F91E"
            "\U0001F3FF"
            "\U0001F91F"
            "\U0001F3FB"
            "\U0001F91F"
            "\U0001F3FC"
            "\U0001F91F"
            "\U0001F3FD"
            "\U0001F91F"
            "\U0001F3FE"
            "\U0001F91F"
            "\U0001F3FF"
            "\U0001F926"
            "\U0001F3FB"
            "\U0001F926"
            "\U0001F3FC"
            "\U0001F926"
            "\U0001F3FD"
            "\U0001F926"
            "\U0001F3FE"
            "\U0001F926"
            "\U0001F3FF"
            "\U0001F930"
            "\U0001F3FB"
            "\U0001F930"
            "\U0001F3FC"
            "\U0001F930"
            "\U0001F3FD"
            "\U0001F930"
            "\U0001F3FE"
            "\U0001F930"
            "\U0001F3FF"
            "\U0001F931"
            "\U0001F3FB"
            "\U0001F931"
            "\U0001F3FC"
            "\U0001F931"
            "\U0001F3FD"
            "\U0001F931"
            "\U0001F3FE"
            "\U0001F931"
            "\U0001F3FF"
            "\U0001F932"
            "\U0001F3FB"
            "\U0001F932"
            "\U0001F3FC"
            "\U0001F932"
            "\U0001F3FD"
            "\U0001F932"
            "\U0001F3FE"
            "\U0001F932"
            "\U0001F3FF"
            "\U0001F933"
            "\U0001F3FB"
            "\U0001F933"
            "\U0001F3FC"
            "\U0001F933"
            "\U0001F3FD"
            "\U0001F933"
            "\U0001F3FE"
            "\U0001F933"
            "\U0001F3FF"
            "\U0001F934"
            "\U0001F3FB"
            "\U0001F934"
            "\U0001F3FC"
            "\U0001F934"
            "\U0001F3FD"
            "\U0001F934"
            "\U0001F3FE"
            "\U0001F934"
            "\U0001F3FF"
            "\U0001F935"
            "\U0001F3FB"
            "\U0001F935"
            "\U0001F3FC"
            "\U0001F935"
            "\U0001F3FD"
            "\U0001F935"
            "\U0001F3FE"
            "\U0001F935"
            "\U0001F3FF"
            "\U0001F936"
            "\U0001F3FB"
            "\U0001F936"
            "\U0001F3FC"
            "\U0001F936"
            "\U0001F3FD"
            "\U0001F936"
            "\U0001F3FE"
            "\U0001F936"
            "\U0001F3FF"
            "\U0001F937"
            "\U0001F3FB"
            "\U0001F937"
            "\U0001F3FC"
            "\U0001F937"
            "\U0001F3FD"
            "\U0001F937"
            "\U0001F3FE"
            "\U0001F937"
            "\U0001F3FF"
            "\U0001F938"
            "\U0001F3FB"
            "\U0001F938"
            "\U0001F3FC"
            "\U0001F938"
            "\U0001F3FD"
            "\U0001F938"
            "\U0001F3FE"
            "\U0001F938"
            "\U0001F3FF"
            "\U0001F939"
            "\U0001F3FB"
            "\U0001F939"
            "\U0001F3FC"
            "\U0001F939"
            "\U0001F3FD"
            "\U0001F939"
            "\U0001F3FE"
            "\U0001F939"
            "\U0001F3FF"
            "\U0001F93D"
            "\U0001F3FB"
            "\U0001F93D"
            "\U0001F3FC"
            "\U0001F93D"
            "\U0001F3FD"
            "\U0001F93D"
            "\U0001F3FE"
            "\U0001F93D"
            "\U0001F3FF"
            "\U0001F93E"
            "\U0001F3FB"
            "\U0001F93E"
            "\U0001F3FC"
            "\U0001F93E"
            "\U0001F3FD"
            "\U0001F93E"
            "\U0001F3FE"
            "\U0001F93E"
            "\U0001F3FF"
            "\U0001F977"
            "\U0001F3FB"
            "\U0001F977"
            "\U0001F3FC"
            "\U0001F977"
            "\U0001F3FD"
            "\U0001F977"
            "\U0001F3FE"
            "\U0001F977"
            "\U0001F3FF"
            "\U0001F9B5"
            "\U0001F3FB"
            "\U0001F9B5"
            "\U0001F3FC"
            "\U0001F9B5"
            "\U0001F3FD"
            "\U0001F9B5"
            "\U0001F3FE"
            "\U0001F9B5"
            "\U0001F3FF"
            "\U0001F9B6"
            "\U0001F3FB"
            "\U0001F9B6"
            "\U0001F3FC"
            "\U0001F9B6"
            "\U0001F3FD"
            "\U0001F9B6"
            "\U0001F3FE"
            "\U0001F9B6"
            "\U0001F3FF"
            "\U0001F9B8"
            "\U0001F3FB"
            "\U0001F9B8"
            "\U0001F3FC"
            "\U0001F9B8"
            "\U0001F3FD"
            "\U0001F9B8"
            "\U0001F3FE"
            "\U0001F9B8"
            "\U0001F3FF"
            "\U0001F9B9"
            "\U0001F3FB"
            "\U0001F9B9"
            "\U0001F3FC"
            "\U0001F9B9"
            "\U0001F3FD"
            "\U0001F9B9"
            "\U0001F3FE"
            "\U0001F9B9"
            "\U0001F3FF"
            "\U0001F9BB"
            "\U0001F3FB"
            "\U0001F9BB"
            "\U0001F3FC"
            "\U0001F9BB"
            "\U0001F3FD"
            "\U0001F9BB"
            "\U0001F3FE"
            "\U0001F9BB"
            "\U0001F3FF"
            "\U0001F9CD"
            "\U0001F3FB"
            "\U0001F9CD"
            "\U0001F3FC"
            "\U0001F9CD"
            "\U0001F3FD"
            "\U0001F9CD"
            "\U0001F3FE"
            "\U0001F9CD"
            "\U0001F3FF"
            "\U0001F9CE"
            "\U0001F3FB"
            "\U0001F9CE"
            "\U0001F3FC"
            "\U0001F9CE"
            "\U0001F3FD"
            "\U0001F9CE"
            "\U0001F3FE"
            "\U0001F9CE"
            "\U0001F3FF"
            "\U0001F9CF"
            "\U0001F3FB"
            "\U0001F9CF"
            "\U0001F3FC"
            "\U0001F9CF"
            "\U0001F3FD"
            "\U0001F9CF"
            "\U0001F3FE"
            "\U0001F9CF"
            "\U0001F3FF"
            "\U0001F9D1"
            "\U0001F3FB"
            "\U0001F9D1"
            "\U0001F3FC"
            "\U0001F9D1"
            "\U0001F3FD"
            "\U0001F9D1"
            "\U0001F3FE"
            "\U0001F9D1"
            "\U0001F3FF"
            "\U0001F9D2"
            "\U0001F3FB"
            "\U0001F9D2"
            "\U0001F3FC"
            "\U0001F9D2"
            "\U0001F3FD"
            "\U0001F9D2"
            "\U0001F3FE"
            "\U0001F9D2"
            "\U0001F3FF"
            "\U0001F9D3"
            "\U0001F3FB"
            "\U0001F9D3"
            "\U0001F3FC"
            "\U0001F9D3"
            "\U0001F3FD"
            "\U0001F9D3"
            "\U0001F3FE"
            "\U0001F9D3"
            "\U0001F3FF"
            "\U0001F9D4"
            "\U0001F3FB"
            "\U0001F9D4"
            "\U0001F3FC"
            "\U0001F9D4"
            "\U0001F3FD"
            "\U0001F9D4"
            "\U0001F3FE"
            "\U0001F9D4"
            "\U0001F3FF"
            "\U0001F9D5"
            "\U0001F3FB"
            "\U0001F9D5"
            "\U0001F3FC"
            "\U0001F9D5"
            "\U0001F3FD"
            "\U0001F9D5"
            "\U0001F3FE"
            "\U0001F9D5"
            "\U0001F3FF"
            "\U0001F9D6"
            "\U0001F3FB"
            "\U0001F9D6"
            "\U0001F3FC"
            "\U0001F9D6"
            "\U0001F3FD"
            "\U0001F9D6"
            "\U0001F3FE"
            "\U0001F9D6"
            "\U0001F3FF"
            "\U0001F9D7"
            "\U0001F3FB"
            "\U0001F9D7"
            "\U0001F3FC"
            "\U0001F9D7"
            "\U0001F3FD"
            "\U0001F9D7"
            "\U0001F3FE"
            "\U0001F9D7"
            "\U0001F3FF"
            "\U0001F9D8"
            "\U0001F3FB"
            "\U0001F9D8"
            "\U0001F3FC"
            "\U0001F9D8"
            "\U0001F3FD"
            "\U0001F9D8"
            "\U0001F3FE"
            "\U0001F9D8"
            "\U0001F3FF"
            "\U0001F9D9"
            "\U0001F3FB"
            "\U0001F9D9"
            "\U0001F3FC"
            "\U0001F9D9"
            "\U0001F3FD"
            "\U0001F9D9"
            "\U0001F3FE"
            "\U0001F9D9"
            "\U0001F3FF"
            "\U0001F9DA"
            "\U0001F3FB"
            "\U0001F9DA"
            "\U0001F3FC"
            "\U0001F9DA"
            "\U0001F3FD"
            "\U0001F9DA"
            "\U0001F3FE"
            "\U0001F9DA"
            "\U0001F3FF"
            "\U0001F9DB"
            "\U0001F3FB"
            "\U0001F9DB"
            "\U0001F3FC"
            "\U0001F9DB"
            "\U0001F3FD"
            "\U0001F9DB"
            "\U0001F3FE"
            "\U0001F9DB"
            "\U0001F3FF"
            "\U0001F9DC"
            "\U0001F3FB"
            "\U0001F9DC"
            "\U0001F3FC"
            "\U0001F9DC"
            "\U0001F3FD"
            "\U0001F9DC"
            "\U0001F3FE"
            "\U0001F9DC"
            "\U0001F3FF"
            "\U0001F9DD"
            "\U0001F3FB"
            "\U0001F9DD"
            "\U0001F3FC"
            "\U0001F9DD"
            "\U0001F3FD"
            "\U0001F9DD"
            "\U0001F3FE"
            "\U0001F9DD"
            "\U0001F3FF"
            "\U0001FAC3"
            "\U0001F3FB"
            "\U0001FAC3"
            "\U0001F3FC"
            "\U0001FAC3"
            "\U0001F3FD"
            "\U0001FAC3"
            "\U0001F3FE"
            "\U0001FAC3"
            "\U0001F3FF"
            "\U0001FAC4"
            "\U0001F3FB"
            "\U0001FAC4"
            "\U0001F3FC"
            "\U0001FAC4"
            "\U0001F3FD"
            "\U0001FAC4"
            "\U0001F3FE"
            "\U0001FAC4"
            "\U0001F3FF"
            "\U0001FAC5"
            "\U0001F3FB"
            "\U0001FAC5"
            "\U0001F3FC"
            "\U0001FAC5"
            "\U0001F3FD"
            "\U0001FAC5"
            "\U0001F3FE"
            "\U0001FAC5"
            "\U0001F3FF"
            "\U0001FAF0"
            "\U0001F3FB"
            "\U0001FAF0"
            "\U0001F3FC"
            "\U0001FAF0"
            "\U0001F3FD"
            "\U0001FAF0"
            "\U0001F3FE"
            "\U0001FAF0"
            "\U0001F3FF"
            "\U0001FAF1"
            "\U0001F3FB"
            "\U0001FAF1"
            "\U0001F3FC"
            "\U0001FAF1"
            "\U0001F3FD"
            "\U0001FAF1"
            "\U0001F3FE"
            "\U0001FAF1"
            "\U0001F3FF"
            "\U0001FAF2"
            "\U0001F3FB"
            "\U0001FAF2"
            "\U0001F3FC"
            "\U0001FAF2"
            "\U0001F3FD"
            "\U0001FAF2"
            "\U0001F3FE"
            "\U0001FAF2"
            "\U0001F3FF"
            "\U0001FAF3"
            "\U0001F3FB"
            "\U0001FAF3"
            "\U0001F3FC"
            "\U0001FAF3"
            "\U0001F3FD"
            "\U0001FAF3"
            "\U0001F3FE"
            "\U0001FAF3"
            "\U0001F3FF"
            "\U0001FAF4"
            "\U0001F3FB"
            "\U0001FAF4"
            "\U0001F3FC"
            "\U0001FAF4"
            "\U0001F3FD"
            "\U0001FAF4"
            "\U0001F3FE"
            "\U0001FAF4"
            "\U0001F3FF"
            "\U0001FAF5"
            "\U0001F3FB"
            "\U0001FAF5"
            "\U0001F3FC"
            "\U0001FAF5"
            "\U0001F3FD"
            "\U0001FAF5"
            "\U0001F3FE"
            "\U0001FAF5"
            "\U0001F3FF"
            "\U0001FAF6"
            "\U0001F3FB"
            "\U0001FAF6"
            "\U0001F3FC"
            "\U0001FAF6"
            "\U0001F3FD"
            "\U0001FAF6"
            "\U0001F3FE"
            "\U0001FAF6"
            "\U0001F3FF"
            "]+",
            flags=re.UNICODE,
        )
        return regrex_pattern.sub(r"", text)

    def geocode_null_addresses(row):
        from geopy.geocoders import Nominatim
        import geopy

        API_KEY = " Avs8af3bGJxAbDECx-tEiM3C53lXeIOCX53-SV-StILZI6OUJq_F4wZ6kIS2RPWn"
        #  geolocator = Nominatim(user_agent="POI_app")
        geolocator = geopy.geocoders.Bing(API_KEY)
        lat = row["lat"]
        lon = row["lon"]

        try:
            location = geolocator.reverse(f"{lat}, {lon}")
        except:
            location = "Undefined"

        address = str(location).split(", ")
        print(", ".join(address[:3]))

        return ", ".join(address[:3])

    def get_centroid(row):
        centroid = row["geometry"].centroid

        return centroid

    def get_city_geometry(city: str = "Новокуйбышевск"):
        import osmnx as ox

        territory = ox.geocode_to_gdf(city)

        print(territory)

        #  territory.to_file('city_geometry.geojson', driver='GeoJSON')

    def get_all_buildings(territory: str = "Новокуйбышевск"):
        import osmnx as ox

        buildings = ox.geometries_from_place(territory, {"building": True})
        buildings = buildings.reset_index()

        buildings["centroid"] = buildings.apply(get_centroid, axis=1)

        buildings["lat"] = buildings.centroid.y
        buildings["lon"] = buildings.centroid.x

        buildings = buildings.set_crs(4326)

        buildings.to_csv("/opt/airflow/dags/buildings.csv")
        print(buildings)

    def split_buildings():
        import pandas as pd

        buildings = pd.read_csv("/opt/airflow/dags/buildings.csv")

        cols = ["name", "geometry", "addr:street", "addr:housenumber", "centroid", "lat", "lon"]

        buildings_with_addresses = buildings[~buildings["addr:housenumber"].isna()][cols]
        buildings_without_addresses = buildings[buildings["addr:housenumber"].isna()][cols]

        #  buildings_with_addresses[["name", "addr:street", "addr:housenumber"]].to_csv("buildings_with_addresses.csv")
        #  buildings_without_addresses.to_file("buildings_without_addresses.geojson", driver="GeoJSON")

        buildings_with_addresses.to_csv("/opt/airflow/dags/buildings_with_addresses.csv")
        buildings_without_addresses.to_csv("/opt/airflow/dags/buildings_without_addresses.csv")
        print(buildings_without_addresses)

    def geocode_buildings_first_part():
        import pandas as pd

        buildings = pd.read_csv("/opt/airflow/dags/buildings_without_addresses.csv")

        length = len(buildings) // 4

        buildings = buildings.loc[:length]

        buildings["address"] = buildings.apply(geocode_null_addresses, axis=1)

        print(buildings)

        buildings = buildings.drop_duplicates(["address"], ignore_index=True)

        buildings.to_csv("/opt/airflow/dags/geocoded_buildings_without_addresses_part1.csv")

    def geocode_buildings_second_part():
        import pandas as pd

        buildings = pd.read_csv("/opt/airflow/dags/buildings_without_addresses.csv")

        length = len(buildings) // 4

        buildings = buildings.loc[length : length * 2]

        buildings["address"] = buildings.apply(geocode_null_addresses, axis=1)

        print(buildings)

        buildings = buildings.drop_duplicates(["address"], ignore_index=True)

        buildings.to_csv("/opt/airflow/dags/geocoded_buildings_without_addresses_part2.csv")

    def geocode_buildings_third_part():
        import pandas as pd

        buildings = pd.read_csv("/opt/airflow/dags/buildings_without_addresses.csv")
        length = len(buildings) // 4

        buildings = buildings.loc[length * 2 : length * 3]
        buildings["address"] = buildings.apply(geocode_null_addresses, axis=1)

        print(buildings)

        buildings = buildings.drop_duplicates(["address"], ignore_index=True)

        buildings.to_csv("/opt/airflow/dags/geocoded_buildings_without_addresses_part3.csv")

    def geocode_buildings_fourth_part():
        import pandas as pd

        buildings = pd.read_csv("/opt/airflow/dags/buildings_without_addresses.csv")
        length = len(buildings) // 4

        buildings = buildings.loc[length * 3 :]
        buildings["address"] = buildings.apply(geocode_null_addresses, axis=1)

        print(buildings)

        buildings = buildings.drop_duplicates(["address"], ignore_index=True)

        buildings.to_csv("/opt/airflow/dags/geocoded_buildings_without_addresses_part4.csv")

    def get_reviews():
        import pandas as pd
        from Yandex_parser import GrabberApp

        data = pd.read_csv("/opt/airflow/dags/geocoded_buildings_without_addresses_part4.csv")

        addresses = data["address"].tolist()

        for address in addresses[0:10]:
            grabber = GrabberApp(address)
            data = grabber.grab_data()
            name = address.replace(",", "_").replace(" ", "_").replace("/", "_")
            print(data)
            data.to_csv(f"./{name}.csv")

    def get_vk_groups(query="Новокуйбышевск"):
        search_groups = vk_api.groups.search(q=query, sort=6, v="5.131")
        groups = [search_groups["items"][i]["screen_name"] for i in range(len(search_groups["items"]))]

        return groups

    def get_posts(domain, offset, count, start_date):
        for i in range(100):
            try:
                result = vk_api.wall.get(domain=domain, offset=offset, count=count, v="5.131")
                result = [[result["items"][i]["text"], result["items"][i]["date"]] for i in range(len(result["items"]))]
                return result
            except:
                continue
        return [["", start_date]]

    def get_group_posts():
        import pandas as pd

        groups = get_vk_groups()

        groups_posts = pd.DataFrame({"group_name": [], "post": [], "date": []})

        for i in range(len(groups)):
            if i % 5 == 0:
                time.sleep(1)
            print(i)
            group_info = []
            current_info = get_posts(domain=groups[i], offset=0, count=10, start_date=start_date)
            if len(current_info) == 0 or current_info[0][1] < final_date:
                continue
            group_info += current_info
            j = 1
            while current_info and start_date > current_info[0][1] > final_date:
                current_info = get_posts(domain=groups[i], offset=10 * j, count=10, start_date=start_date)
                j += 1
                for post in current_info:
                    print(post)
                    groups_posts.loc[groups_posts.shape[0]] = {
                        "group_name": groups[i],
                        "post": post[0],
                        "date": post[1],
                    }

        groups_posts.to_csv("/opt/airflow/dags/groups_posts.csv")

    def get_news(query="Новокуйбышевск"):
        import time

        global start_date

        step = 800

        city_posts = pd.DataFrame({"group_name": [], "post": [], "date": []})

        while start_date >= final_date:
            search_by_query = vk_api.newsfeed.search(
                q=query, count=200, v="5.131", start_time=final_date, end_time=start_date
            )
            search_by_query = [search_by_query["items"][i]["text"] for i in range(len(search_by_query["items"]))]
            start_date -= step
            for post in search_by_query:
                city_posts.loc[city_posts.shape[0]] = {"group_name": query, "post": post[0], "date": post[1]}
            time.sleep(0.3)

        city_posts.to_csv("/opt/airflow/dags/city_posts.csv")

    def get_photos():
        import time

        step = 800

        city_photos = pd.DataFrame({"post": [], "date": []})

        while start_date >= final_date:
            search_by_coordinates = vk_api.photos.search(
                count=1000,
                latitude=latitude,
                longitude=longitude,
                v="5.131",
                start_time=start_date,
                end_time=final_date,
                radius=50000,
            )
            search_by_coordinates = [
                search_by_coordinates["items"][i]["text"] for i in range(len(search_by_coordinates["items"]))
            ]
            start_date -= step
            for post in search_by_coordinates:
                city_photos.loc[city_photos.shape[0]] = {"post": post[0], "date": post[1]}

            time.sleep(0.3)

        city_photos.to_csv("/opt/airflow/dags/city_photos.csv")

    def stanza_nlp_ru(text):
        doc = nlp(text)
        return [[ent.text, ent.type] for sent in doc.sentences for ent in sent.ents]

    def predict_emotion(text):
        import torch
        from transformers import AutoModelForSequenceClassification
        from transformers import BertTokenizerFast

        tokenizer = BertTokenizerFast.from_pretrained("blanchefort/rubert-base-cased-sentiment")
        model = AutoModelForSequenceClassification.from_pretrained(
            "blanchefort/rubert-base-cased-sentiment", return_dict=True
        )

        inputs = tokenizer(text, max_length=512, padding=True, truncation=True, return_tensors="pt")
        outputs = model(**inputs)
        predicted = torch.nn.functional.softmax(outputs.logits, dim=1)
        predicted = torch.argmax(predicted, dim=1).numpy()
        return predicted

    def analyze_text(groups):
        places = []

        emotions = {0: "NEUTRAL", 1: "POSITIVE", 2: "NEGATIVE"}

        for group in groups:
            data = pd.read_parquet(f"/opt/airflow/dags/city_photos.csv")

            print(group)
            for i in range(data.shape[0]):
                text = str(data.iloc[i][1])

                if len(text) < 2:
                    print("No text")
                    continue
                text = remove_emoji(text)

                result = predict_emotion(data.iloc[i][1])

                entities = stanza_nlp_ru(text)
                for ent in entities:
                    if ent[1] == "LOC":
                        places.append([ent[0], emotions[result[0]]])

    get_city_geometry_task = PythonOperator(
        task_id="get_city_geometry",
        python_callable=get_city_geometry,
        provide_context=True,
    )

    get_all_buildings_task = PythonOperator(
        task_id="get_all_buildings",
        python_callable=get_all_buildings,
        provide_context=True,
    )

    split_buildings_task = PythonOperator(
        task_id="split_buildings",
        python_callable=split_buildings,
        provide_context=True,
    )

    geocode_buildings_task1 = PythonOperator(
        task_id="geocode_buildings1",
        python_callable=geocode_buildings_first_part,
        provide_context=True,
    )

    geocode_buildings_task2 = PythonOperator(
        task_id="geocode_buildings2",
        python_callable=geocode_buildings_second_part,
        provide_context=True,
    )

    geocode_buildings_task3 = PythonOperator(
        task_id="geocode_buildings3",
        python_callable=geocode_buildings_third_part,
        provide_context=True,
    )

    geocode_buildings_task4 = PythonOperator(
        task_id="geocode_buildings4",
        python_callable=geocode_buildings_fourth_part,
        provide_context=True,
    )

    reviews_task = PythonOperator(
        task_id="get_reviews",
        python_callable=get_reviews,
        provide_context=True,
    )

    vk_groups_task = PythonOperator(
        task_id="get_group_posts",
        python_callable=get_group_posts,
        provide_context=True,
    )

    vk_news_task = PythonOperator(
        task_id="get_photos",
        python_callable=get_news,
        provide_context=True,
    )

    vk_photos_task = PythonOperator(
        task_id="get_news",
        python_callable=get_photos,
        provide_context=True,
    )

(
    get_city_geometry_task
    >> [get_all_buildings_task, vk_groups_task, vk_news_task, vk_photos_task]
    #   >> split_buildings_task
    #   >> [geocode_buildings_task1, geocode_buildings_task2, geocode_buildings_task3, geocode_buildings_task4]
    #  >> reviews_task
)
